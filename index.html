<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <link rel="icon" type="image/png" href="logo.png">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel Upload and Analyze</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>

<body>
    <div class="container">
        <div class="header-section">
            <button class="notice-button" onclick="showToastMessage()">
                <i class="fas fa-info-circle"></i>
            </button>
            <img src="logo1.png" alt="logo" width="400" height="400" class="centered-image">
            <h1>Employee Attendance Calculator</h1>
            <p style="color: #7f8c8d; font-size: 1.1rem; margin-bottom: 0;">Streamline your workforce management with precision</p>
        </div>

        <div class="main-content" id="mainContent">
            <div class="controls-section">
                <div class="button-container">
                    <input type="file" id="fileInput" accept=".xlsx, .xls, .csv">
                    <label class="file-input-label" for="fileInput">
                        <i class="fas fa-cloud-upload-alt"></i> Choose File
                    </label>
                    <div class="file-input-container">
                        <span id="fileName">No file selected</span>
                    </div>
                    <button class="calculate-button" onclick="processFile()">
                        <i class="fas fa-calculator"></i> Calculate
                    </button>
                    <button class="export-button" onclick="exportToExcel()">
                        <i class="fas fa-download"></i> Export
                    </button>
                    <button class="clear-button" onclick="clearFile()">
                        <i class="fas fa-trash-alt"></i> Clear
                    </button>
                </div>
            </div>

            <div id="output"></div>
        </div>
    </div>

    <footer>
        <div class="footer-content">
            <div class="footer-left">
                <p>&copy; <span id="current-year"></span> KFL Manpower Agency. All rights reserved. ©TeamFroggy</p>
                <script>
                    document.getElementById("current-year").textContent = new Date().getFullYear();
                </script>
            </div>
            <div class="footer-right">
                <ul>
                    <li><a href="#" onclick="event.preventDefault(); showPrivacyPolicyModal()">Privacy Policy</a></li>
                    <li><a href="#" onclick="event.preventDefault(); showTermsModal()">Terms of Service</a></li>
                    <li><a href="#" onclick="event.preventDefault(); showContactModal()">Contact Us</a></li>
                </ul>
            </div>
        </div>
        <div class="footer-social">
            <a href="https://www.facebook.com/kflmanpoweragencyofficialpage/" target="_blank" class="social-icon"><i class="fab fa-facebook-f"></i></a>
            <a href="https://twitter.com" target="_blank" class="social-icon"><i class="fab fa-twitter"></i></a>
            <a href="https://google.com" target="_blank" class="social-icon"><i class="fab fa-google"></i></a>
            <a href="https://linkedin.com" target="_blank" class="social-icon"><i class="fab fa-linkedin-in"></i></a>
        </div>
    </footer>

    <div id="modal" class="modal">
        <div class="modal-content" id="modal-content">
        </div>
    </div>

    <div id="toast" class="toast">
        <div id="toast-message"></div>
        <button class="close-btn" onclick="closeToast()">×</button>
    </div>

    <script>
        function showToast(message) {
            const toast = document.getElementById("toast");
            const toastMessage = document.getElementById("toast-message");
            toastMessage.textContent = message;
            toast.classList.add("show");
            setTimeout(() => {
                toast.classList.remove("show");
            }, 5000);
        }

        function showPrivacyPolicyModal() {
            const modal = document.getElementById("modal");
            const modalContent = document.getElementById("modal-content");

            modalContent.innerHTML = `
                <button class="close-btn" onclick="closeModal()">&times;</button>
                <h2>Privacy Policy</h2>
                <p><strong>Effective Date:</strong> January 20, 2025</p>
                
                <p>Welcome to Employee Attendance Calculator! Your privacy is very important to us. This Privacy Policy outlines the types of personal information we collect, how we use it, and the measures we take to protect your data.</p>

                <h4>Information We Collect</h4>
                <p>We may collect the following types of information:</p>
                <ul>
                    <li>Personal identification information (e.g., name, email address, phone number)</li>
                    <li>Browser and device information</li>
                    <li>IP addresses and usage data</li>
                </ul>

                <h4>How We Use Your Information</h4>
                <p>We use the information we collect for the following purposes:</p>
                <ul>
                    <li>To provide and maintain our service</li>
                    <li>To communicate with you, including customer support</li>
                    <li>To improve our website and services</li>
                    <li>To comply with legal obligations</li>
                </ul>

                <h4>Contact Us</h4>
                <p>If you have any questions about this Privacy Policy, please contact us at <a href="mailto:it@kflmanpoweragency.com">it@kflmanpoweragency.com</a>.</p>
            `;
            
            // Add animation
            modal.style.opacity = '0';
            modal.style.transform = 'scale(0.7)';
            modal.classList.add("show");
            
            setTimeout(() => {
                modal.style.transition = 'all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55)';
                modal.style.opacity = '1';
                modal.style.transform = 'scale(1)';
            }, 10);
        }

        function showTermsModal() {
            const modal = document.getElementById("modal");
            const modalContent = document.getElementById("modal-content");

            modalContent.innerHTML = `
                <button class="close-btn" onclick="closeModal()">&times;</button>
                <h2>Terms of Service</h2>
                <p><strong>Effective Date:</strong> January 20, 2025</p>
                
                <p>Welcome to Employee Attendance Calculator! These Terms of Service govern your access to and use of our website and services.</p>

                <h4>Use of Service</h4>
                <p>You agree to use our services only for lawful purposes and in a manner consistent with all applicable laws and regulations.</p>

                <h4>Limitation of Liability</h4>
                <p>KFL Manpower Agency will not be liable for any indirect, incidental, or consequential damages arising from your use of our services.</p>

                <h4>Termination</h4>
                <p>We reserve the right to terminate or suspend your access to our services at any time for any reason, including but not limited to a breach of these Terms.</p>

                <h4>Changes to These Terms</h4>
                <p>We may update these Terms from time to time. We will notify you of any changes by posting the updated Terms on our website.</p>

                <h4>Contact Us</h4>
                <p>If you have any questions about these Terms, please contact us at <a href="mailto:admin@kflmanpoweragency.com">admin@kflmanpoweragency.com</a>.</p>
            `;
            
            // Add animation
            modal.style.opacity = '0';
            modal.style.transform = 'scale(0.7)';
            modal.classList.add("show");
            
            setTimeout(() => {
                modal.style.transition = 'all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55)';
                modal.style.opacity = '1';
                modal.style.transform = 'scale(1)';
            }, 10);
        }

        function showContactModal() {
            const modal = document.getElementById("modal");
            const modalContent = document.getElementById("modal-content");

            modalContent.innerHTML = `
                <button class="close-btn" onclick="closeModal()">&times;</button>
                <h2>Contact Us</h2>
                <p>We'd love to hear from you! Get in touch with us using the information below:</p>

                <h4>Email</h4>
                <p><a href="mailto:admin@kflmanpoweragency.com">admin@kflmanpoweragency.com</a></p>

                <h4>Phone</h4>
                <p>+63 123 456 7890</p>

                <h4>Address</h4>
                <p>KFL Manpower Agency<br>
                123 Business Street<br>
                Manila, Philippines</p>

                <h4>Business Hours</h4>
                <p>Monday - Friday: 8:00 AM - 5:00 PM<br>
                Saturday: 9:00 AM - 1:00 PM<br>
                Sunday: Closed</p>
            `;
            
            // Add animation
            modal.style.opacity = '0';
            modal.style.transform = 'scale(0.7)';
            modal.classList.add("show");
            
            setTimeout(() => {
                modal.style.transition = 'all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55)';
                modal.style.opacity = '1';
                modal.style.transform = 'scale(1)';
            }, 10);
        }

        function closeModal() {
            const modal = document.getElementById("modal");
            
            // Add exit animation
            modal.style.transition = 'all 0.3s ease';
            modal.style.opacity = '0';
            modal.style.transform = 'scale(0.7)';
            
            setTimeout(() => {
                modal.classList.remove("show");
                modal.style.transform = 'scale(1)';
            }, 300);
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById("modal");
            if (event.target === modal) {
                closeModal();
            }
        }

        function closeToast() {
            const toast = document.getElementById("toast");
            toast.classList.remove("show");
        }

        function showToastMessage() {
            showToast("Important: Please ensure your Excel file contains the required columns: Employee Name, Date, Time In, and Time Out for accurate attendance calculation.");
        }

        // Add compact layout functionality
        function toggleCompactLayout(compact) {
            const headerSection = document.querySelector('.header-section');
            const mainContent = document.getElementById('mainContent');
            
            if (compact) {
                headerSection.classList.add('compact');
                mainContent.classList.add('has-data');
            } else {
                headerSection.classList.remove('compact');
                mainContent.classList.remove('has-data');
            }
        }

        // Override processFile to add compact layout
        const originalProcessFile = window.processFile;
        window.processFile = function() {
            toggleCompactLayout(true);
            if (originalProcessFile) {
                originalProcessFile();
            }
        };

        // Override clearFile to restore layout
        const originalClearFile = window.clearFile;
        window.clearFile = function() {
            toggleCompactLayout(false);
            if (originalClearFile) {
                originalClearFile();
            }
        };
    </script>

    <style>
        * {
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 25%, #43e97b 75%, #38f9d7 100%);
            color: #333;
            overflow-x: hidden;
        }

        .container {
            flex: 1;
            padding: 10px;
            text-align: center;
            max-width: 1200px;
            margin: 0 auto;
            width: 100%;
            display: flex;
            flex-direction: column;
            min-height: calc(100vh - 120px);
        }

        @media (min-width: 768px) {
            .container {
                padding: 20px;
            }
        }

        .header-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            flex-shrink: 0;
            position: relative;
        }

        @media (max-width: 768px) {
            .header-section {
                padding: 10px;
                margin-bottom: 10px;
            }
        }



        .header-section.compact {
            padding: 5px;
            margin-bottom: 5px;
        }

        .header-section.compact .centered-image {
            max-width: 120px;
        }

        .header-section.compact h1 {
            font-size: 1rem;
            margin: 2px 0;
        }

        .header-section.compact p {
            font-size: 0.8rem;
            margin: 2px 0;
        }

        .header-section.compact .notice-button {
            padding: 8px;
            font-size: 12px;
            top: 5px;
            right: 5px;
            width: 30px;
            height: 30px;
        }

        .centered-image {
            max-width: 200px;
            height: auto;
            margin-bottom: 10px;
        }

        @media (max-width: 768px) {
            .centered-image {
                max-width: 150px;
                margin-bottom: 5px;
            }
        }

        h1 {
            color: #2c3e50;
            font-size: 1.8rem;
            margin: 10px 0;
            font-weight: 700;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.4rem;
                margin: 5px 0;
            }
        }

        .main-content {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        @media (max-width: 768px) {
            .main-content {
                padding: 15px;
                border-radius: 15px;
            }
        }

        .controls-section {
            flex-shrink: 0;
            margin-bottom: 10px;
        }

        .main-content.has-data {
            padding: 10px;
        }

        .main-content.has-data .controls-section {
            margin-bottom: 5px;
        }

        .main-content.has-data .file-input-container {
            display: none;
        }

        .main-content.has-data .button-container {
            margin: 0 0 10px 0;
            order: -1;
        }

        .main-content.has-data .calculate-button,
        .main-content.has-data .export-button,
        .main-content.has-data .clear-button {
            padding: 8px 16px;
            font-size: 12px;
            min-width: 80px;
        }

        footer {
            background: linear-gradient(45deg, #2c3e50, #34495e);
            color: white;
            padding: 40px 0 20px 0;
            margin-top: auto;
            flex-shrink: 0;
            position: relative;
            overflow: hidden;
            border-radius: 50px 50px 0 0;
        }

        footer::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 150px;
            height: 150px;
            background: url('logo.png') center/contain no-repeat;
            transform: translate(-50%, -50%);
            opacity: 0.3;
            animation: logoRotate 10s linear infinite;
            z-index: 0;
        }

        @keyframes logoRotate {
            from { transform: translate(-50%, -50%) rotate(0deg); }
            to { transform: translate(-50%, -50%) rotate(360deg); }
        }

        footer::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 200%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(79, 172, 254, 0.1), 
                rgba(0, 242, 254, 0.2), 
                rgba(67, 233, 123, 0.1), 
                transparent);
            animation: wave 4s linear infinite;
        }

        @keyframes wave {
            0% {
                transform: translateX(-100%);
            }
            100% {
                transform: translateX(50%);
            }
        }

        .footer-content {
            position: relative;
            z-index: 1;
        }

        .footer-social {
            position: relative;
            z-index: 1;
        }

        @media (max-width: 768px) {
            footer {
                padding: 15px 0;
            }
        }

        .footer-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        @media (max-width: 768px) {
            .footer-content {
                flex-direction: column;
                text-align: center;
                gap: 10px;
            }
            
            .footer-right ul {
                flex-wrap: wrap;
                justify-content: center;
                gap: 15px;
            }
        }

        .footer-left p {
            margin: 0;
            justify-items: start;
        }

        .footer-right ul {
            list-style: none;
            display: flex;
            gap: 20px;
            margin: 0;
            padding: 0;
        }

        .footer-right a {
            color: white;
            text-decoration: none;
        }

        .footer-right a:hover {
            color: #ccc;
        }

        .footer-social {
            text-align: center;
            margin-top: 15px;
        }

        .social-icon {
            color: white;
            font-size: 20px;
            margin: 0 10px;
            text-decoration: none;
        }

        .social-icon:hover {
            color: #ccc;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 20px;
            border-radius: 10px;
            width: 80%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
        }

        .modal.show {
            display: block;
        }

        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: #333;
            color: white;
            padding: 20px;
            border-radius: 5px;
            max-width: 400px;
            max-height: 80vh;
            overflow-y: auto;
            transform: translateX(100%);
            transition: transform 0.3s ease;
            z-index: 1000;
        }

        .toast.show {
            transform: translateX(0);
        }

        .close-btn {
            position: absolute;
            top: 10px;
            right: 15px;
            background: none;
            border: none;
            color: #333;
            font-size: 24px;
            cursor: pointer;
            z-index: 1001;
        }

        .close-btn:hover {
            color: #e74c3c;
        }

        .toast .close-btn {
            color: white;
        }

        .notice-button {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            color: white;
            border: none;
            padding: 12px;
            border-radius: 50%;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(231, 76, 60, 0.3);
            position: absolute;
            top: 10px;
            right: 10px;
            margin: 0;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .notice-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(231, 76, 60, 0.4);
        }

        .button-container {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            margin: 25px 0;
        }

        @media (max-width: 768px) {
            .button-container {
                gap: 10px;
                margin: 20px 0;
            }
        }

        .calculate-button, .export-button, .clear-button {
            padding: 15px 30px;
            border: none;
            border-radius: 30px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            min-width: 120px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        @media (max-width: 768px) {
            .calculate-button, .export-button, .clear-button {
                padding: 12px 24px;
                font-size: 14px;
                min-width: 100px;
            }
        }

        .calculate-button {
            background: linear-gradient(45deg, #27ae60, #2ecc71);
            color: white;
            box-shadow: 0 4px 15px rgba(39, 174, 96, 0.3);
        }

        .calculate-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(39, 174, 96, 0.4);
        }

        .export-button {
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        }

        .export-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4);
        }

        .clear-button {
            background: linear-gradient(45deg, #f39c12, #e67e22);
            color: white;
            box-shadow: 0 4px 15px rgba(243, 156, 18, 0.3);
        }

        .clear-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(243, 156, 18, 0.4);
        }

        .file-input-container {
            margin: 0;
            padding: 15px 20px;
            border: 2px dashed #4facfe;
            border-radius: 20px;
            background: rgba(255, 255, 255, 0.6);
            transition: all 0.3s ease;
            text-align: center;
            display: inline-flex;
            align-items: center;
            min-width: 150px;
        }

        .file-input-container:hover {
            border-color: #00f2fe;
            background: rgba(255, 255, 255, 0.9);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(79, 172, 254, 0.2);
        }

        #fileName {
            font-style: italic;
            color: #555;
            font-size: 14px;
            font-weight: 500;
        }

        @media (max-width: 768px) {
            .file-input-container {
                margin: 10px 0;
                padding: 12px 15px;
                min-width: 120px;
            }
            
            .button-container {
                flex-direction: column;
                align-items: center;
            }
        }

        .file-input-label {
            display: inline-block;
            padding: 15px 30px;
            background: linear-gradient(45deg, #4facfe, #00f2fe);
            color: white;
            border-radius: 30px;
            cursor: pointer;
            font-weight: 600;
            font-size: 16px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(79, 172, 254, 0.3);
            flex-shrink: 0;
            min-width: 120px;
            text-align: center;
        }

        @media (max-width: 768px) {
            .file-input-label {
                padding: 12px 24px;
                font-size: 14px;
                min-width: 100px;
            }
        }

        .file-input-label:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(79, 172, 254, 0.4);
        }

        #fileInput {
            display: none;
        }

        #fileName {
            font-style: italic;
            color: #7f8c8d;
            font-size: 14px;
            margin-top: 10px;
            display: block;
        }

        #output {
            flex: 1;
            overflow-y: auto;
            border-radius: 10px;
            min-height: 0;
        }

        .main-content.has-data #output {
            margin-top: 0;
            flex: 1;
        }

        .main-content.has-data .table-container {
            max-height: 350px;
            overflow-y: auto;
        }

        .main-content.has-data .table-container::-webkit-scrollbar {
            width: 8px;
        }

        .main-content.has-data .table-container::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        .main-content.has-data .table-container::-webkit-scrollbar-thumb {
            background: #4facfe;
            border-radius: 4px;
        }

        .main-content.has-data .table-container::-webkit-scrollbar-thumb:hover {
            background: #00f2fe;
        }

        .table-container {
            width: 100%;
            overflow-x: auto;
            overflow-y: auto;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            height: 340px;
        }

        table {
            width: 100%;
            min-width: 800px;
            border-collapse: collapse;
            background: white;
        }

        th, td {
            padding: 8px 12px;
            text-align: left;
            border-bottom: 1px solid #ecf0f1;
            font-size: 13px;
        }

        th {
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 11px;
            letter-spacing: 0.5px;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        tr:hover {
            background-color: #f8f9fa;
        }

        input[type="text"] {
            padding: 10px 15px;
            border: 2px solid #ecf0f1;
            border-radius: 25px;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        input[type="text"]:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 10px rgba(52, 152, 219, 0.2);
        }
    </style>
    <script src="attendance_fixed.js"></script>
</body>

</html>